# Calendar Events Feature - Flow Diagram

## System Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                         USER INTERFACE                          │
│                                                                 │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    │
│  │  Dashboard   │───▶│   Calendar   │───▶│   Drafts     │    │
│  │    Page      │    │  Events Page │    │     Tab      │    │
│  └──────────────┘    └──────────────┘    └──────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         API LAYER                               │
│                                                                 │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    │
│  │  /api/       │    │  /api/events/│    │  /api/events/│    │
│  │  settings    │    │  generate    │    │  suggestions │    │
│  └──────────────┘    └──────────────┘    └──────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      AI PROCESSING                              │
│                                                                 │
│                    ┌──────────────┐                            │
│                    │  Gemini AI   │                            │
│                    │   (Google)   │                            │
│                    └──────────────┘                            │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    DATA STORAGE                                 │
│                                                                 │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    │
│  │   Settings   │    │    Events    │    │    Posts     │    │
│  │    Table     │    │    Table     │    │   (Drafts)   │    │
│  └──────────────┘    └──────────────┘    └──────────────┘    │
│                                                                 │
│              Azure Table Storage                                │
└─────────────────────────────────────────────────────────────────┘
```

## User Flow

```
START
  │
  ▼
┌─────────────────────┐
│ User logs in        │
│ to Dashboard        │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ Clicks "Calendar    │
│ Events" tab         │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐      NO      ┌─────────────────────┐
│ Settings            │─────────────▶│ User configures:    │
│ configured?         │              │ - Company name      │
└─────────────────────┘              │ - Brand identity    │
  │ YES                              │ - Customer profile  │
  │                                  └─────────────────────┘
  │                                            │
  │◀───────────────────────────────────────────┘
  ▼
┌─────────────────────┐
│ User clicks         │
│ "Generate Events    │
│ & Suggestions"      │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ System checks for   │
│ existing events     │
│ (next 30 days)      │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐      YES     ┌─────────────────────┐
│ Events exist?       │─────────────▶│ Use existing events │
└─────────────────────┘              └─────────────────────┘
  │ NO                                         │
  │                                            │
  ▼                                            │
┌─────────────────────┐                       │
│ AI generates 15     │                       │
│ calendar events     │                       │
│ (Gemini AI)         │                       │
└─────────────────────┘                       │
  │                                            │
  ▼                                            │
┌─────────────────────┐                       │
│ Save events to      │                       │
│ database            │                       │
└─────────────────────┘                       │
  │                                            │
  │◀───────────────────────────────────────────┘
  ▼
┌─────────────────────┐
│ AI generates social │
│ post suggestions    │
│ for each event      │
│ (Gemini AI)         │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ Save posts as       │
│ drafts in database  │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ Display:            │
│ - Events table      │
│ - "View Suggested   │
│   Posts" button     │
│ - Confirmation msg  │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ User clicks "View   │
│ Suggested Posts"    │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ Navigate to Drafts  │
│ tab with suggested  │
│ posts               │
└─────────────────────┘
  │
  ▼
┌─────────────────────┐
│ User reviews,       │
│ edits, and          │
│ publishes posts     │
└─────────────────────┘
  │
  ▼
END
```

## Data Flow

```
Settings Input
     │
     ▼
┌──────────────────────────────────────┐
│ Company Name: "SageSure Insurance"   │
│ Brand: "Professional, trustworthy"   │
│ Customer: "Homeowners 35-65"         │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│         Gemini AI Prompt             │
│  "Generate 15 business-relevant      │
│   calendar events for SageSure..."   │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│         AI Response (JSON)           │
│  [                                   │
│    {                                 │
│      "title": "National Insurance    │
│                Awareness Day",       │
│      "date": "2025-11-25",          │
│      "description": "...",           │
│      "category": "Awareness Day"     │
│    },                                │
│    ...                               │
│  ]                                   │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│      Save to Events Table            │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│    Generate Post Suggestions         │
│  "Create social posts for these      │
│   events aligned with brand..."      │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│         AI Response (JSON)           │
│  [                                   │
│    {                                 │
│      "eventTitle": "...",            │
│      "content": "Protect what        │
│                  matters most...",   │
│      "platforms": ["linkedin",...]   │
│    },                                │
│    ...                               │
│  ]                                   │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│    Save to Posts Table (Drafts)     │
└──────────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│      Display to User                 │
│  - Events table                      │
│  - Link to drafts                    │
└──────────────────────────────────────┘
```

## Component Interaction

```
┌─────────────────────────────────────────────────────────────┐
│                    Calendar Page Component                  │
│                                                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐    │
│  │   Settings   │  │   Generate   │  │    Events    │    │
│  │    Modal     │  │    Button    │  │    Table     │    │
│  └──────────────┘  └──────────────┘  └──────────────┘    │
│         │                 │                   │            │
│         │                 │                   │            │
│         ▼                 ▼                   ▼            │
│  ┌──────────────────────────────────────────────────┐    │
│  │              Component State                      │    │
│  │  - user                                          │    │
│  │  - settings                                      │    │
│  │  - events                                        │    │
│  │  - generating                                    │    │
│  │  - socialAgentUrl                                │    │
│  └──────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
```

## API Request/Response Flow

```
Client                    API                      AI                  Database
  │                        │                       │                      │
  │  POST /api/settings    │                       │                      │
  │───────────────────────▶│                       │                      │
  │                        │  Save settings        │                      │
  │                        │──────────────────────────────────────────────▶│
  │                        │                       │                      │
  │  POST /api/events/     │                       │                      │
  │       generate         │                       │                      │
  │───────────────────────▶│                       │                      │
  │                        │  Get settings         │                      │
  │                        │──────────────────────────────────────────────▶│
  │                        │◀──────────────────────────────────────────────│
  │                        │  Generate events      │                      │
  │                        │──────────────────────▶│                      │
  │                        │◀──────────────────────│                      │
  │                        │  Save events          │                      │
  │                        │──────────────────────────────────────────────▶│
  │◀───────────────────────│                       │                      │
  │                        │                       │                      │
  │  POST /api/events/     │                       │                      │
  │       suggestions      │                       │                      │
  │───────────────────────▶│                       │                      │
  │                        │  Generate posts       │                      │
  │                        │──────────────────────▶│                      │
  │                        │◀──────────────────────│                      │
  │                        │  Save as drafts       │                      │
  │                        │──────────────────────────────────────────────▶│
  │◀───────────────────────│                       │                      │
  │                        │                       │                      │
```
